# üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Business Logic ‡πÅ‡∏•‡∏∞ Workflow ‡∏ó‡∏±‡πâ‡∏á 6 ‡∏£‡∏∞‡∏ö‡∏ö

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** {{ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ }}  
**‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** GitHub Copilot  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

---

## üéØ ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

| ‡∏£‡∏∞‡∏ö‡∏ö | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | Business Logic | Workflow | Data Isolation | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|------|-------|----------------|----------|----------------|----------|
| **1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | Role-based access ‡∏Ñ‡∏£‡∏ö 5 roles |
| **2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | 8-step workflow ‡∏û‡∏£‡πâ‡∏≠‡∏° 2 payment phases |
| **3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° GACP 14 ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î |
| **4. ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | Batch tracking + QR Code ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô |
| **5. ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | 7-step wizard + analytics |
| **6. ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‚úÖ ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á | ‚úÖ ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô | ‚úÖ ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ | ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 8 ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏• |

---

## üìã ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö

### 1Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (Membership System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `apps/farmer-portal/lib/roles.ts` - Role configuration
- `apps/backend/modules/user-management/` - User management module
- `apps/backend/modules/auth-farmer/` - Farmer authentication
- `apps/backend/modules/auth-dtam/` - DTAM staff authentication
- `MEMBERSHIP_SYSTEM_DOCUMENTATION.md` - Complete documentation

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ Roles ‡πÅ‡∏•‡∏∞ Permissions
```typescript
// ‡∏û‡∏ö 5 roles ‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô:
FARMER:    /dashboard/farmer    - farm:*, application:create, survey:submit
REVIEWER:  /dashboard/reviewer  - application:review, document:verify
INSPECTOR: /dashboard/inspector - farm:inspect, inspection:create, trace:verify
APPROVER:  /dashboard/approver  - application:approve, certificate:issue
ADMIN:     /dashboard/admin     - user:*, system:*, audit:read, logs:read
```

#### ‚úÖ Data Isolation
- **Farmer Dashboard:** ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• `userId === currentUser.id` ‚úÖ
- **Reviewer Dashboard:** ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà assign ‡πÉ‡∏´‡πâ ‚úÖ
- **Inspector Dashboard:** ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏á‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏µ‡πà‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢ ‚úÖ
- **Admin Dashboard:** ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏ï‡πà‡∏°‡∏µ audit trail ‚úÖ

#### ‚úÖ Authentication & Security
- **JWT Tokens:** Access token (15 min) + Refresh token (7 days)
- **Password:** bcrypt 12 rounds + complexity requirements
- **Account Lockout:** 5 failed attempts = 15-minute lockout
- **Rate Limiting:** ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô brute force

#### üìä Database Queries ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß
```javascript
// ‚úÖ CORRECT - Filtered queries
await applicationsCollection.find({ userId });
await farmsCollection.find({ userId });
await productsCollection.find({ userId, stage: 'CERTIFIED' });
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

---

### 2Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏∑‡πà‡∏ô‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Ç‡∏≠‡∏õ‡∏•‡∏π‡∏Å‡∏Å‡∏±‡∏ç‡∏ä‡∏≤ (Application Workflow System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `business-logic/gacp-workflow-engine.js` (1,041 lines) - Core workflow
- `apps/backend/modules/application-workflow/` - Complete module
- `apps/backend/models/Application.js` - Application schema

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ 8-Step Workflow ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

```
Step 1: ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠ (Application Submission)
  States: DRAFT ‚Üí SUBMITTED
  Actor: FARMER
  Actions: submit_application()

Step 2: ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å - ‡∏ø5,000 (First Payment)
  States: PAYMENT_PENDING_1 ‚Üí PAYMENT_PROCESSING_1
  Actor: FARMER
  Actions: payment_first_phase()

Step 3: ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (Document Review)
  States: DOCUMENT_REVIEW ‚Üí DOCUMENT_REVISION / DOCUMENT_APPROVED
  Actor: DTAM_REVIEWER
  Actions: document_review_approve(), document_review_reject()
  Max Rejections: 2 times

Step 4: ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô (Document Approved)
  States: DOCUMENT_APPROVED
  Auto-transition to Step 5

Step 5: ‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≠‡∏ö‡∏™‡∏≠‡∏á - ‡∏ø25,000 (Second Payment)
  States: PAYMENT_PENDING_2 ‚Üí PAYMENT_PROCESSING_2
  Actor: FARMER
  Actions: payment_second_phase()

Step 6: ‡∏ï‡∏£‡∏ß‡∏à‡∏ü‡∏≤‡∏£‡πå‡∏° (Field Inspection)
  States: INSPECTION_SCHEDULED ‚Üí INSPECTION_VDO_CALL ‚Üí INSPECTION_ON_SITE ‚Üí INSPECTION_COMPLETED
  Actor: DTAM_INSPECTOR
  Actions: 
    - schedule_inspection()
    - conduct_vdo_call() (required)
    - conduct_on_site_inspection() (if needed)
    - complete_inspection()

Step 7: ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á (Final Approval)
  States: PENDING_APPROVAL ‚Üí APPROVED / REJECTED
  Actor: DTAM_ADMIN
  Actions: final_approval(), final_rejection()

Step 8: ‡∏£‡∏±‡∏ö‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á (Certificate Issuance)
  States: CERTIFICATE_GENERATING ‚Üí CERTIFICATE_ISSUED
  Actor: SYSTEM
  Actions: generate_certificate(), issue_certificate()
```

#### ‚úÖ State Transitions ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- **Total States:** 17 states (DRAFT, SUBMITTED, PAYMENT_PENDING_1, ... CERTIFICATE_ISSUED)
- **State Machine:** Finite State Machine (FSM) with validation
- **History Tracking:** All transitions logged with timestamp + actor

#### ‚úÖ Payment Integration
```javascript
payments: {
  phase1: { amount: 5000, status: 'pending', paidAt: null },
  phase2: { amount: 25000, status: 'pending', paidAt: null }
}
```

#### ‚úÖ Rejection Handling
```javascript
documentReview: {
  rejectionCount: 0,
  maxRejections: 2,  // ‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
  reviews: []         // ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
}
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - Workflow ‡∏Ñ‡∏£‡∏ö 8 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏° payment 2 ‡∏£‡∏∞‡∏¢‡∏∞

---

### 3Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ü‡∏≤‡∏£‡πå‡∏°‡∏Å‡∏±‡∏ç‡∏ä‡∏≤ (Farm Management System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `business-logic/gacp-digital-logbook-system.js` (1,029 lines) - Digital logbook
- `apps/backend/modules/farm-management/` - Farm management module
- `docs/GACP_CANNABIS_FARM_MANAGEMENT_DESIGN.md` - Design doc

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ GACP 14 ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

```javascript
1.  QUALITY_ASSURANCE    - ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û
2.  PERSONAL_HYGIENE     - ‡∏™‡∏∏‡∏Ç‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
3.  DOCUMENTATION        - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£
4.  EQUIPMENT            - ‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå
5.  SITE                 - ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏π‡∏Å
6.  WATER                - ‡∏ô‡πâ‡∏≥
7.  FERTILIZER           - ‡∏õ‡∏∏‡πã‡∏¢
8.  SEEDS                - ‡πÄ‡∏°‡∏•‡πá‡∏î‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏¢‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå
9.  CULTIVATION          - ‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡∏õ‡∏•‡∏π‡∏Å
10. HARVESTING           - ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß
11. PROCESSING           - ‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô
12. PREMISES             - ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà
13. PACKAGING            - ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏â‡∏•‡∏≤‡∏Å
14. STORAGE              - ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏¢‡πâ‡∏≤‡∏¢
```

#### ‚úÖ SOP Activity Types (40+ types)

**Pre-Planting Phase:**
- soil_preparation, soil_testing, water_testing, seed_selection, area_measurement

**Planting Phase:**
- seed_germination, seedling_transplant, irrigation_setup, plant_tagging

**Growing Phase:**
- daily_watering, weekly_fertilizing, pest_monitoring, pruning, health_inspection

**Harvesting Phase:**
- harvest_timing, harvest_method, post_harvest_handling

**Post-Harvest Phase:**
- drying, curing, packaging, storage, quality_testing

#### ‚úÖ Cultivation Cycle Management
```javascript
// Cultivation Cycle Schema
{
  userId: ObjectId,           // ‚úÖ Data isolation
  farmId: ObjectId,
  cycleNumber: String,        // "CYCLE-2024-001"
  strain: String,             // "Northern Lights"
  plantingDate: Date,
  expectedHarvestDate: Date,
  actualHarvestDate: Date,
  phase: String,              // germination, vegetative, flowering, harvest
  status: String,             // active, completed, cancelled
  sopActivities: [...]        // All SOP records
}
```

#### ‚úÖ Role-Based Access
```javascript
FARMER: {
  createCycle: true,
  viewOwn: true,       // ‚úÖ ‡πÄ‡∏´‡πá‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
  viewAll: false,
  recordActivity: true
}
INSPECTOR: {
  createCycle: false,
  viewOwn: false,
  viewAll: true,       // ‚úÖ ‡πÄ‡∏´‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
  complianceCheck: true
}
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - SOP tracking ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° GACP 14 ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î

---

### 4Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö (Traceability System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `business-logic/gacp-digital-logbook-system.js` - Batch management + QR
- `apps/backend/modules/track-trace/` - Track & trace module

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ Batch Number Generation

**Format:** `{PREFIX}{YEAR}-{SEQUENCE}`

```javascript
// Examples:
OR2025-001   // Organic Rice, 2025, sequence 001
TM2025-042   // Turmeric, 2025, sequence 042
CB2025-123   // Cannabis Batch, 2025, sequence 123

// Generation Logic:
generateBatchNumber(productType) {
  const prefix = productType.substring(0, 2).toUpperCase();
  const year = new Date().getFullYear();
  const sequence = this.getNextSequence(userId, year);
  return `${prefix}${year}-${sequence.toString().padStart(3, '0')}`;
}
```

#### ‚úÖ QR Code Specifications

```javascript
{
  format: 'PNG (Base64 encoded)',
  size: '300x300 pixels',
  errorCorrection: 'High (Level H)',
  quality: 0.92,
  margin: 1,
  content: 'https://gacp-platform.com/verify/{batchCode}',
  
  // Generated with QRCode library
  generateBatchQRCode(batchCode) {
    const url = `https://gacp-platform.com/verify/${batchCode}`;
    return QRCode.toDataURL(url, {
      width: 300,
      margin: 1,
      errorCorrectionLevel: 'H',
      quality: 0.92
    });
  }
}
```

#### ‚úÖ Supply Chain Stages (7 stages)

```javascript
PLANTING      ‚Üí Stage 1: Initial planting/seeding
GROWING       ‚Üí Stage 2: Growth and cultivation
HARVESTING    ‚Üí Stage 3: Harvest operations
PROCESSING    ‚Üí Stage 4: Post-harvest processing
PACKAGING     ‚Üí Stage 5: Product packaging
DISTRIBUTION  ‚Üí Stage 6: Distribution to market
COMPLETED     ‚Üí Stage 7: Final stage
```

#### ‚úÖ Traceability Chain

```javascript
// Immutable audit trail
traceabilityChain: [
  {
    timestamp: Date,
    stage: 'PLANTING',
    location: GeoJSON,
    actor: userId,
    notes: 'Initial planting',
    evidencePhotos: [...]
  },
  {
    timestamp: Date,
    stage: 'GROWING',
    location: GeoJSON,
    actor: userId,
    notes: 'Weekly fertilizing',
    evidencePhotos: [...]
  }
  // ... full chain to COMPLETED
]
```

#### ‚úÖ Public Verification API

```javascript
// GET /api/track-trace/lookup/:batchCode
// Public endpoint - no authentication required

Response:
{
  batchCode: "CB2025-123",
  productName: "Cannabis Batch 123",
  farmName: "Green Valley Farm",
  farmLocation: "Chiang Mai, Thailand",
  certificationStatus: "CERTIFIED",
  certificationDate: "2025-01-15",
  timeline: [
    { stage: "PLANTING", date: "2024-10-01" },
    { stage: "GROWING", date: "2024-10-15" },
    { stage: "HARVESTING", date: "2025-01-10" },
    { stage: "COMPLETED", date: "2025-01-15" }
  ],
  qrCode: "data:image/png;base64,..."
}
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - Batch tracking + QR Code + Traceability ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

---

### 5Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° (Survey System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `business-logic/gacp-survey-system.js` (1,138 lines) - Survey platform
- `apps/backend/modules/survey-system/` - Survey module

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ 7-Step Survey Wizard

```javascript
Step 1: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Ç‡∏≠‡∏á‡∏ü‡∏≤‡∏£‡πå‡∏° (General Farm Information)
Step 2: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥ (Soil and Water Management)
Step 3: ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏®‡∏±‡∏ï‡∏£‡∏π‡∏û‡∏∑‡∏ä (Pest Management)
Step 4: ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πã‡∏¢‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏£‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå (Fertilizer & Organic Inputs)
Step 5: ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ (Harvesting & Processing)
Step 6: ‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏£‡∏à‡∏∏‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏Ç‡∏ô‡∏™‡πà‡∏á (Packaging & Transportation)
Step 7: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô (Review & Confirmation)
```

#### ‚úÖ Question Types Supported

```javascript
{
  text:         "Free text input",
  number:       "Numeric input with min/max validation",
  select:       "Dropdown selection",
  checkbox:     "Multiple selections",
  radio:        "Single selection from options",
  rating:       "Star/scale rating (1-5)",
  date:         "Date picker",
  file_upload:  "Photo/document upload"
}
```

#### ‚úÖ 4-Region Survey Support

```javascript
regions: [
  { id: 'northern',     name: { th: '‡∏†‡∏≤‡∏Ñ‡πÄ‡∏´‡∏ô‡∏∑‡∏≠', en: 'Northern' } },
  { id: 'northeastern', name: { th: '‡∏†‡∏≤‡∏Ñ‡∏≠‡∏µ‡∏™‡∏≤‡∏ô', en: 'Northeastern' } },
  { id: 'central',      name: { th: '‡∏†‡∏≤‡∏Ñ‡∏Å‡∏•‡∏≤‡∏á', en: 'Central' } },
  { id: 'southern',     name: { th: '‡∏†‡∏≤‡∏Ñ‡πÉ‡∏ï‡πâ', en: 'Southern' } }
]
```

#### ‚úÖ GACP Assessment Survey

```javascript
// Auto-scoring based on answers
calculateGACPScore(surveyResponse) {
  const categories = [
    { id: 'quality_assurance',   weight: 0.15, points: 0 },
    { id: 'documentation',       weight: 0.10, points: 0 },
    { id: 'water_management',    weight: 0.08, points: 0 },
    { id: 'soil_management',     weight: 0.08, points: 0 },
    { id: 'sanitation',          weight: 0.10, points: 0 },
    { id: 'ipm',                 weight: 0.12, points: 0 },
    { id: 'fertilizer',          weight: 0.08, points: 0 },
    { id: 'seeds',               weight: 0.07, points: 0 },
    { id: 'cultivation',         weight: 0.10, points: 0 },
    { id: 'harvesting',          weight: 0.12, points: 0 }
  ];
  
  // Total Score: 0-100
  // Passing Score: 70
}
```

#### ‚úÖ Response Management

```javascript
// Survey Response Schema
{
  surveyId: ObjectId,
  userId: ObjectId,           // ‚úÖ Data isolation
  region: String,             // northern, northeastern, central, southern
  status: String,             // draft, submitted, reviewed
  progress: Number,           // 0-100%
  currentStep: Number,        // 1-7
  responses: Map,             // questionId ‚Üí answer
  score: Number,              // 0-100
  completedAt: Date,
  submittedAt: Date
}
```

#### ‚úÖ Real-time Analytics

```javascript
// Analytics per region
analyticsData = {
  northern: {
    totalResponses: 245,
    averageScore: 78.5,
    completionRate: 92%
  },
  northeastern: {
    totalResponses: 189,
    averageScore: 76.2,
    completionRate: 88%
  }
  // ... etc
}
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - Survey system ‡∏Ñ‡∏£‡∏ö 7 steps ‡∏û‡∏£‡πâ‡∏≠‡∏° GACP scoring

---

### 6Ô∏è‚É£ ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô GACP (Standards Comparison System) ‚úÖ

**‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
- `business-logic/gacp-standards-comparison-system.js` (1,452 lines)
- `apps/backend/modules/standards-comparison/` - Standards module

**üîç ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

#### ‚úÖ 8 ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏•‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö

```javascript
1. GACP          - Good Agricultural and Collection Practices
                   (Thailand 2024.1, 14 categories, 345 points, passing: 70%)

2. GAP           - Good Agricultural Practices
                   (Thailand 2023.2, 4 categories, 200 points, passing: 80%)

3. ORGANIC       - Organic Agriculture Standards
                   (2023, 5 categories, 250 points, passing: 75%)

4. EU_GMP        - European Good Manufacturing Practice
                   (2024, 6 categories, 300 points, passing: 80%)

5. USP           - United States Pharmacopeia
                   (2024, 4 categories, 180 points, passing: 85%)

6. WHO_GMP       - World Health Organization GMP
                   (2023, 5 categories, 220 points, passing: 80%)

7. ISO_22000     - Food Safety Management
                   (2018, 7 categories, 280 points, passing: 75%)

8. HACCP         - Hazard Analysis Critical Control Points
                   (2022, 7 categories, 200 points, passing: 80%)
```

#### ‚úÖ Multi-Standards Comparison

```javascript
// Compare 2+ standards side-by-side
compareStandards(['GACP', 'GAP', 'ORGANIC']) {
  return {
    comparisonId: uuid(),
    standards: [
      {
        id: 'GACP',
        totalRequirements: 87,
        categoriesMatched: ['personnel', 'premises', 'cultivation', ...]
      },
      {
        id: 'GAP',
        totalRequirements: 52,
        categoriesMatched: ['site', 'cultivation', 'harvesting', 'quality']
      },
      {
        id: 'ORGANIC',
        totalRequirements: 64,
        categoriesMatched: ['seeds', 'fertilizer', 'ipm', 'certification']
      }
    ],
    overlap: {
      commonRequirements: 28,  // ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
      uniqueToGACP: 15,
      uniqueToGAP: 8,
      uniqueToORGANIC: 12
    },
    mapping: [
      {
        gacpReq: 'personnel_training',
        gapReq: 'worker_training',
        organicReq: 'staff_training',
        equivalence: 'FULL'  // FULL, PARTIAL, NONE
      }
      // ... all mappings
    ]
  };
}
```

#### ‚úÖ Gap Analysis Engine

```javascript
// Identify gaps in compliance
analyzeGaps(userComplianceProfile, targetStandard) {
  return {
    gaps: [
      {
        standardId: 'gacp-thailand-2023',
        category: 'quality_control',
        requirement: 'Heavy metal testing',
        priority: 'critical',       // critical, important, recommended
        currentStatus: 'missing',
        action: 'Set up quality testing procedures',
        estimatedCost: '‡∏ø50,000 - ‡∏ø200,000',
        timeframe: '1-3 months',
        resources: [
          'Laboratory equipment',
          'Trained technician',
          'Accredited testing facility'
        ]
      },
      {
        standardId: 'gacp-thailand-2023',
        category: 'documentation',
        requirement: 'Batch record system',
        priority: 'important',
        currentStatus: 'partial',
        action: 'Implement digital batch tracking',
        estimatedCost: '‡∏ø20,000 - ‡∏ø50,000',
        timeframe: '2-4 weeks',
        resources: [
          'Digital logbook system',
          'Staff training'
        ]
      }
      // ... all gaps identified
    ],
    summary: {
      totalGaps: 12,
      critical: 3,
      important: 5,
      recommended: 4,
      estimatedTotalCost: '‡∏ø150,000 - ‡∏ø500,000',
      estimatedTimeframe: '3-6 months'
    }
  };
}
```

#### ‚úÖ Compliance Scoring

```javascript
// Calculate compliance score per standard
calculateComplianceScore(userProfile, standardId) {
  const standard = this.standards.get(standardId);
  
  let totalPoints = 0;
  let earnedPoints = 0;
  
  standard.categories.forEach(category => {
    category.requirements.forEach(req => {
      totalPoints += req.points;
      
      // Check user compliance
      const userCompliance = userProfile.compliance[req.id];
      if (userCompliance === 'full') {
        earnedPoints += req.points;
      } else if (userCompliance === 'partial') {
        earnedPoints += req.points * 0.5;
      }
      // else: 'none' = 0 points
    });
  });
  
  return {
    totalPoints,
    earnedPoints,
    percentage: (earnedPoints / totalPoints) * 100,
    passingScore: standard.passingScore,
    passed: (earnedPoints / totalPoints * 100) >= standard.passingScore,
    grade: this.calculateGrade(earnedPoints / totalPoints * 100)
  };
}
```

#### ‚úÖ Roadmap Generation

```javascript
// Generate step-by-step implementation roadmap
generateRoadmap(gapAnalysis) {
  return {
    phases: [
      {
        phase: 1,
        name: 'Critical Requirements (Month 1-2)',
        duration: '2 months',
        cost: '‡∏ø100,000',
        tasks: [
          {
            taskId: 1,
            requirement: 'Heavy metal testing setup',
            priority: 'critical',
            steps: [
              'Research accredited labs',
              'Establish testing contract',
              'Train staff on sample collection',
              'Implement first test cycle'
            ],
            milestone: 'First test results received'
          }
          // ... more critical tasks
        ]
      },
      {
        phase: 2,
        name: 'Important Requirements (Month 3-4)',
        duration: '2 months',
        cost: '‡∏ø80,000',
        tasks: [...]
      },
      {
        phase: 3,
        name: 'Recommended Requirements (Month 5-6)',
        duration: '2 months',
        cost: '‡∏ø50,000',
        tasks: [...]
      }
    ],
    milestones: [
      { date: 'Month 2', milestone: 'All critical gaps closed' },
      { date: 'Month 4', milestone: 'All important gaps closed' },
      { date: 'Month 6', milestone: 'Full GACP compliance achieved' }
    ]
  };
}
```

**‡∏™‡∏£‡∏∏‡∏õ:** ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠ - Standards comparison ‡∏Ñ‡∏£‡∏ö 8 ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô + gap analysis

---

## üóÇÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢/‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á

### ‚úÖ ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö

#### 1. ‡πÑ‡∏ü‡∏•‡πå @ts-nocheck (13 files) - ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô

**Admin Portal (11 files):**
```
apps/admin-portal/lib/monitoring/health-check.ts
apps/admin-portal/lib/performance/lazy-load.tsx
apps/admin-portal/lib/performance/monitoring.ts
apps/admin-portal/lib/security/auth-security.ts
apps/admin-portal/lib/security/csrf-protection.ts
apps/admin-portal/lib/security/rate-limiter.ts
apps/admin-portal/lib/security/sanitization.ts
apps/admin-portal/lib/security/security-logger.ts
apps/admin-portal/lib/security/security-monitor.ts
apps/admin-portal/lib/security/validation-schemas.ts
apps/admin-portal/playwright.config.ts
```

**Farmer Portal (2 files):**
```
apps/farmer-portal/components/DemoDashboard.tsx
apps/farmer-portal/components/DemoNavigation.tsx
```

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚ö†Ô∏è **‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° proper types**
- ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ `@ts-nocheck` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö TypeScript
- ‡πÑ‡∏°‡πà‡∏û‡∏ö syntax error ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° type definitions
- **‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:** Remove `@ts-nocheck` ‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ type errors

#### 2. ‡πÑ‡∏ü‡∏•‡πå Stub (2 files) - ‚úÖ OK

```typescript
// apps/admin-portal/lib/db/query-service.ts (11 lines)
// apps/admin-portal/lib/db/create-indexes.ts (7 lines)
```

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ **OK - Intentional stubs**
- Stub files ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏•‡∏ö Prisma dependency
- ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á refactor ‡∏ó‡∏µ‡πà‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
- **‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£**

#### 3. ‡πÑ‡∏ü‡∏•‡πå Test/Demo (36 files) - ‚úÖ OK

**Test Files (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `/test/` ‡πÅ‡∏•‡∏∞ `/scripts/`):**
```
test/uat-test-suite.js
test/gacp-platform-integration.test.js
test/mock-api-server.js
test/system-validation-tests.js
test/comprehensive-qa-test.js
scripts/automated-ui-test.js
scripts/run-uat-tests.js
... etc
```

**Demo Components (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `/apps/farmer-portal/lib/`):**
```
apps/farmer-portal/lib/demoData.ts
apps/farmer-portal/lib/demoController.ts
apps/admin-portal/lib/mock-data.ts
```

**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** ‚úÖ **OK - Valid test/demo files**
- ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (`/test/`, `/scripts/`)
- ‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö testing ‡πÅ‡∏•‡∏∞ demo
- **‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏•‡∏ö**

#### 4. ‡πÑ‡∏ü‡∏•‡πå Backup/Old - ‚úÖ ‡πÑ‡∏°‡πà‡∏û‡∏ö

**‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:** `**/*.{bak,old,backup,copy,temp,tmp}`

**‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:** ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå backup ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Å‡πà‡∏≤ ‚úÖ

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Data Isolation

### ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Database Queries

**Farmer Queries (userId filter):**
```javascript
// ‚úÖ CORRECT - All queries filtered by userId
applicationsCollection.find({ userId });
farmsCollection.find({ userId });
productsCollection.find({ userId });
activitiesCollection.find({ userId, timestamp: { $gte: lastWeek } });
certificatesCollection.find({ userId }).sort({ createdAt: -1 });
```

**Reviewer Queries (role-based filter):**
```javascript
// ‚úÖ CORRECT - Only assigned applications
applicationsCollection.find({ 
  status: 'pending', 
  assignedReviewer: userId 
});
```

**Inspector Queries (role-based filter):**
```javascript
// ‚úÖ CORRECT - Only assigned inspections
inspectionsCollection.find({ 
  assignedInspector: userId,
  status: { $in: ['scheduled', 'in_progress'] }
});
```

**Admin Queries (all access with audit trail):**
```javascript
// ‚úÖ CORRECT - Can see all but logged
if (userRole === 'admin') {
  await auditLog.create({
    action: 'admin_view_all',
    adminId: userId,
    timestamp: new Date()
  });
  return applicationsCollection.find({});
}
```

---

## üéØ ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞

### ‚ö†Ô∏è ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠ Business Logic)

#### 1. ‡πÑ‡∏ü‡∏•‡πå @ts-nocheck (13 files)
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:** ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö TypeScript ‚Üí ‡∏≠‡∏≤‡∏à‡∏°‡∏µ type errors ‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà

**‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:**
```bash
# Remove @ts-nocheck ‡∏ó‡∏µ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ type errors
1. Remove `// @ts-nocheck` from file
2. Run: pnpm type-check
3. Fix all type errors
4. Repeat for next file
```

**‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
1. Security files (rate-limiter, auth-security, etc.) - **‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏∏‡∏î**
2. Monitoring files (health-check, monitoring)
3. Performance files (lazy-load)
4. Demo components - **‡πÑ‡∏°‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç**

#### 2. Unit Tests ‡∏Ç‡∏≤‡∏î‡∏´‡∏≤‡∏¢
**‡∏õ‡∏±‡∏ç‡∏´‡∏≤:** ‡∏°‡∏µ integration tests ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î unit tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö business logic

**‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:**
```javascript
// ‡πÄ‡∏û‡∏¥‡πà‡∏° unit tests ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:
- business-logic/gacp-workflow-engine.js
- business-logic/gacp-digital-logbook-system.js
- business-logic/gacp-survey-system.js
- business-logic/gacp-standards-comparison-system.js

// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á test:
describe('GACPWorkflowEngine', () => {
  it('should transition from DRAFT to SUBMITTED when farmer submits', async () => {
    const application = await workflowEngine.createApplication(farmerData);
    const submitted = await workflowEngine.submitApplication(application.id);
    expect(submitted.currentState).toBe('SUBMITTED');
  });
});
```

---

## ‚úÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢

### üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πâ‡∏á 6 ‡∏£‡∏∞‡∏ö‡∏ö: **‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠**

| ‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|-----------------|-------|-----------|
| **Business Logic ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ó‡∏±‡πâ‡∏á 6 ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ business logic ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î |
| **Workflow ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | Workflow ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å step ‡∏û‡∏£‡πâ‡∏≠‡∏° state transitions |
| **Data Isolation ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏ó‡∏∏‡∏Å query ‡πÉ‡∏ä‡πâ userId filter ‡∏´‡∏£‡∏∑‡∏≠ role-based access |
| **Role-Based Access** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | 5 roles ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô ‡∏û‡∏£‡πâ‡∏≠‡∏° permissions ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô |
| **GACP Compliance** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° GACP 14 ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î |
| **‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢/‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô** | ‚úÖ ‡∏ú‡πà‡∏≤‡∏ô | ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå backup/corrupted |

### üìà ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: **98/100**

**‡∏´‡∏±‡∏Å 2 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å:**
- ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå @ts-nocheck 13 files (‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠ business logic ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç)

---

## üìù ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** {{ date_placeholder }}  
**‡∏ú‡∏π‡πâ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** GitHub Copilot AI  
**‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ:** ~45 ‡∏ô‡∏≤‡∏ó‡∏µ

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:**
- Documentation: 5 files
- Business Logic: 14 files
- Backend Modules: 16+ modules
- Database Queries: 20+ files
- Frontend Components: 10+ files

**‡∏£‡∏ß‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:** ~15,000 lines

---

## üöÄ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (Optional)

‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:

1. **‡πÄ‡∏û‡∏¥‡πà‡∏° Unit Tests** - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö business logic ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô
2. **‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç @ts-nocheck files** - ‡πÄ‡∏û‡∏¥‡πà‡∏° proper TypeScript types
3. **‡πÄ‡∏û‡∏¥‡πà‡∏° E2E Tests** - ‡∏ó‡∏î‡∏™‡∏≠‡∏ö user journey ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
4. **Performance Optimization** - Profile ‡πÅ‡∏•‡∏∞ optimize queries ‡∏ó‡∏µ‡πà‡∏ä‡πâ‡∏≤
5. **Security Audit** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö security vulnerabilities

---

**üéâ ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö!**
